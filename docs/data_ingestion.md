# Data Ingestion
We chose not to work directly on the database. We want to create a first assessment of the baseline quality criteria as defined in the proposal. Since, we do not want to disturb our production process with this Proof of Concept we decided to extract the data first to a local file system. Another reason to this, is that it provides us with the opportunity to test our aquired skills. Our source data are tables with a geometry collumn. These tables are stored in an Oracle database with ESRI's Spatial Data Engine (SDE) (ESRI, 1999). The tables are configured with the versioning and archiving mechanics provided in the ESRI SDE. The historic rows are stored in a different table and we need to read these tables. We used ETL-software FME from Safe Software (Safe Software, 2025). FME is an abbreviation and stand for Feature Manipulation Engine. The application reads features from any format and converts them to it's own format. In this form the feature can be transformed after which they can be loaded to any format again.

# Selecting the tables to read
First step is to create a list of the tables which use archiving. We have to use an ESRI python package wich can access the SDE. This package is arcpy. The PythonCreator of FME is a template Python file to create FME features. We provided a copy of the Python code in the Python Creator. A printscreen of the ETL-proces is provided as well. The screenshot provides some in canvas documentation. The process runs from left to right. It makes a list of all tables to read. _H is concatenated to the tablename and the history-tables are read. This process can write to CSV or GeoParquet. For CSV the geometry is written in Well Known Text if a geometry is available. 

We used both CSV and GeoParquet as target format. We wanted to compare the size between both formats and to leave the option open to compare the differences in performance in subsequent steps.

References:
ESRI, 1999, Spatial Database Engine - technical paper, https://support.esri.com/en-us/technical-paper/spatial-database-engine-sde-270 
Safe Software, 2025, Website introducing FME, https://fme.safe.com/ visited on 26-11-2025